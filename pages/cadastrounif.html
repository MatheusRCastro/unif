<!DOCTYPE html>
<html lang="pt-BR">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Cadastro - UNIF</title>
  <link rel="stylesheet" href="styles/cadastrounif.css">
  <link rel="stylesheet" href="styles/global.css">
  <script src="scripts/cadastrounif.js" defer></script>
</head>

<script>
 async function enviarCadastro(formData) {
    try {
        const response = await fetch('cadastro.php', {
            method: 'POST',
            body: formData
        });
        
        const texto = await response.text();
        console.log('Resposta do servidor:', texto);
        
        // Dividir a resposta pelo primeiro ":"
        const partes = texto.split(':');
        const status = partes[0]; // "1" para sucesso, "0" para erro
        const mensagem = partes.slice(1).join(':'); // resto da mensagem
        
        if (status === '1') {
            alert('✅ ' + mensagem);
            // Redirecionar ou limpar formulário
            window.location.href = 'login.html';
        } else {
            alert('❌ ' + mensagem);
        }
        
    } catch (error) {
        console.error('Erro na requisição:', error);
        alert('Erro na conexão com o servidor');
    }
}

// Uso
document.querySelector('form').addEventListener('submit', function(e) {
    e.preventDefault();
    const formData = new FormData(this);
    enviarCadastro(formData);
});
</script>

<body>
  <div class="container">

    <!-- Logo -->
    <div class="logo-box">
      <img src="images/unif.png" alt="Logo UNIF" class="logo">
    </div>

    <!-- Formulário -->
    <div class="form-box">
      <h2>CADASTRE SUA CONTA :</h2>
      <form id="cadastroForm">
        <div class="scrollable-form">
          <!-- Adicione name em todos os campos -->
          <input type="email" name="email" placeholder="E-mail" required>
          <input type="text" name="cpf" placeholder="CPF" required>

          <div class="password-container">
            <input type="password" name="senha" placeholder="Senha" required>
          </div>
          <div class="password-container">
            <input type="password" name="confirmar_senha" placeholder="Confirmar senha" required>
          </div>

          <input type="text" name="telefone" placeholder="Número de telefone" required>
          <input type="text" name="instituicao" placeholder="Informe sua instituição" required>
          <input type="text" name="medicamento" placeholder="Faz uso de algum medicamento? (se não, deixar em branco)">

          <label for="Oa">Selecione uma opção alimentar:</label>
          <select id="Oa" name="opcao_alimentar">
            <option value="Oa1">Veganismo</option>
            <option value="Oa2">Vegetarianismo</option>
            <option value="Oa3">Tradicional</option>
          </select>

          <input type="text" name="alergia" placeholder="Tem alguma alergia? (se não, deixar em branco)">
          <input type="text" name="restricao_alimentar" placeholder="Tem alguma restrição alimentar? (se não, deixar em branco)">

          <label>Você é um professor acompanhante?</label>
          <div class="radio-group">
            <button type="button" onclick="mostrarCampos(true)">Sim</button>
            <button type="button" onclick="mostrarCampos(false)">Não</button>
          </div>

          <!-- Campo hidden para enviar se é professor -->
          <input type="hidden" name="eh_professor" id="eh_professor" value="false">

          <div id="camposProf">
            <input type="text" name="telefone_instituicao" placeholder="Informe o número de contato da sua instituição">
            <input type="email" name="email_instituicao" placeholder="Informe o e-mail de contato da sua instituição">
          </div>
        </div>

        <button type="submit">Submeter</button>
      </form>
    </div>
  </div>
</body>

</html>
